<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="EVM database commit interface."><title>DatabaseCommit in forge::revm::database - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../../static.files/rustdoc-aa0817cf.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="forge" data-themes="" data-resource-suffix="" data-rustdoc-version="1.90.0-nightly (ab68b0fb2 2025-07-08)" data-channel="nightly" data-search-js="search-179e01a3.js" data-settings-js="settings-5514c975.js" ><script src="../../../static.files/storage-4e99c027.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../../static.files/main-673ee1e0.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-32bb7600.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-6580c154.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-044be391.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../forge/index.html">forge</a><span class="version">1.2.3</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Database<wbr>Commit</a></h2><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.commit" title="commit">commit</a></li></ul><h3><a href="#foreign-impls">Implementations on Foreign Types</a></h3><ul class="block"><li><a href="#impl-DatabaseCommit-for-%26mut+T" title="&#38;&#39;a mut T">&#38;&#39;a mut T</a></li><li><a href="#impl-DatabaseCommit-for-ActiveOverlay%3CDb%3E" title="ActiveOverlay&#60;Db&#62;">ActiveOverlay&#60;Db&#62;</a></li><li><a href="#impl-DatabaseCommit-for-Box%3CT%3E" title="Box&#60;T&#62;">Box&#60;T&#62;</a></li><li><a href="#impl-DatabaseCommit-for-ForkDb%3CExtDb%3E" title="ForkDb&#60;ExtDb&#62;">ForkDb&#60;ExtDb&#62;</a></li><li><a href="#impl-DatabaseCommit-for-MemDb" title="MemDb">MemDb</a></li><li><a href="#impl-DatabaseCommit-for-MultiForkDb%3CExtDb%3E" title="MultiForkDb&#60;ExtDb&#62;">MultiForkDb&#60;ExtDb&#62;</a></li><li><a href="#impl-DatabaseCommit-for-OverlayDb%3CDb%3E" title="OverlayDb&#60;Db&#62;">OverlayDb&#60;Db&#62;</a></li></ul><h3><a href="#implementors">Implementors</a></h3></section><div id="rustdoc-modnav"><h2><a href="index.html">In forge::<wbr>revm::<wbr>database</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../../index.html">forge</a>::<wbr><a href="../index.html">revm</a>::<wbr><a href="index.html">database</a></div><h1>Trait <span class="trait">DatabaseCommit</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"></span></div><pre class="rust item-decl"><code>pub trait DatabaseCommit {
    // Required method
    fn <a href="#tymethod.commit" class="fn">commit</a>(&amp;mut self, changes: <a class="struct" href="../primitives/map/hash_map/struct.HashMap.html" title="struct forge::revm::primitives::map::hash_map::HashMap">HashMap</a>&lt;<a class="struct" href="../primitives/struct.Address.html" title="struct forge::revm::primitives::Address">Address</a>, <a class="struct" href="../state/struct.Account.html" title="struct forge::revm::state::Account">Account</a>, <a class="struct" href="../primitives/map/foldhash/fast/struct.RandomState.html" title="struct forge::revm::primitives::map::foldhash::fast::RandomState">RandomState</a>&gt;);
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>EVM database commit interface.</p>
</div></details><h2 id="required-methods" class="section-header">Required Methods<a href="#required-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="tymethod.commit" class="method"><h4 class="code-header">fn <a href="#tymethod.commit" class="fn">commit</a>(&amp;mut self, changes: <a class="struct" href="../primitives/map/hash_map/struct.HashMap.html" title="struct forge::revm::primitives::map::hash_map::HashMap">HashMap</a>&lt;<a class="struct" href="../primitives/struct.Address.html" title="struct forge::revm::primitives::Address">Address</a>, <a class="struct" href="../state/struct.Account.html" title="struct forge::revm::state::Account">Account</a>, <a class="struct" href="../primitives/map/foldhash/fast/struct.RandomState.html" title="struct forge::revm::primitives::map::foldhash::fast::RandomState">RandomState</a>&gt;)</h4></section></summary><div class="docblock"><p>Commit changes to the database.</p>
</div></details></div><h2 id="foreign-impls" class="section-header">Implementations on Foreign Types<a href="#foreign-impls" class="anchor">§</a></h2><details class="toggle implementors-toggle"><summary><section id="impl-DatabaseCommit-for-MemDb" class="impl"><a href="#impl-DatabaseCommit-for-MemDb" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="../trait.DatabaseCommit.html" title="trait forge::revm::DatabaseCommit">DatabaseCommit</a> for MemDb</h3></section></summary><div class="impl-items"><section id="method.commit" class="method trait-impl"><a href="#method.commit" class="anchor">§</a><h4 class="code-header">fn <a class="fn">commit</a>(&amp;mut self, changes: <a class="struct" href="../primitives/map/hash_map/struct.HashMap.html" title="struct forge::revm::primitives::map::hash_map::HashMap">HashMap</a>&lt;<a class="struct" href="../primitives/struct.Address.html" title="struct forge::revm::primitives::Address">Address</a>, <a class="struct" href="../state/struct.Account.html" title="struct forge::revm::state::Account">Account</a>, <a class="struct" href="../primitives/map/foldhash/fast/struct.RandomState.html" title="struct forge::revm::primitives::map::foldhash::fast::RandomState">RandomState</a>&gt;)</h4></section></div></details><details class="toggle implementors-toggle"><summary><section id="impl-DatabaseCommit-for-%26mut+T" class="impl"><a href="#impl-DatabaseCommit-for-%26mut+T" class="anchor">§</a><h3 class="code-header">impl&lt;'a, T&gt; <a class="trait" href="../trait.DatabaseCommit.html" title="trait forge::revm::DatabaseCommit">DatabaseCommit</a> for <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;'a mut T</a><div class="where">where
    T: 'a + <a class="trait" href="../trait.DatabaseCommit.html" title="trait forge::revm::DatabaseCommit">DatabaseCommit</a> + ?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</div></h3></section></summary><div class="impl-items"><section id="method.commit-1" class="method trait-impl"><a href="#method.commit-1" class="anchor">§</a><h4 class="code-header">fn <a class="fn">commit</a>(&amp;mut self, changes: <a class="struct" href="../primitives/map/hash_map/struct.HashMap.html" title="struct forge::revm::primitives::map::hash_map::HashMap">HashMap</a>&lt;<a class="struct" href="../primitives/struct.Address.html" title="struct forge::revm::primitives::Address">Address</a>, <a class="struct" href="../state/struct.Account.html" title="struct forge::revm::state::Account">Account</a>, <a class="struct" href="../primitives/map/foldhash/fast/struct.RandomState.html" title="struct forge::revm::primitives::map::foldhash::fast::RandomState">RandomState</a>&gt;)</h4></section></div></details><details class="toggle implementors-toggle"><summary><section id="impl-DatabaseCommit-for-ActiveOverlay%3CDb%3E" class="impl"><a href="#impl-DatabaseCommit-for-ActiveOverlay%3CDb%3E" class="anchor">§</a><h3 class="code-header">impl&lt;Db&gt; <a class="trait" href="../trait.DatabaseCommit.html" title="trait forge::revm::DatabaseCommit">DatabaseCommit</a> for ActiveOverlay&lt;Db&gt;</h3><div class="docblock"><p>Implementation of <code>DatabaseCommit</code> for <code>ActiveOverlay</code>.</p>
</div></section></summary><div class="docblock"><p>This implementation commits EVM state changes only to the overlay cache,
not to the underlying database. This allows temporary state modifications
that can be shared across multiple database instances through the same cache.</p>
<h4 id="example"><a class="doc-anchor" href="#example">§</a>Example</h4>
<div class="example-wrap ignore"><a href="#" class="tooltip" title="This example is not tested">ⓘ</a><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::cell::UnsafeCell;
<span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>active_db = Arc::new(UnsafeCell::new(some_db));
<span class="kw">let </span>cache = Cache::new(<span class="number">1024</span>);
<span class="kw">let </span><span class="kw-2">mut </span>active_overlay = ActiveOverlay::new(active_db, cache);

<span class="comment">// Commit state changes to the shared cache
</span>active_overlay.commit(state_changes);</code></pre></div>
</div><div class="impl-items"><section id="method.commit-2" class="method trait-impl"><a href="#method.commit-2" class="anchor">§</a><h4 class="code-header">fn <a class="fn">commit</a>(&amp;mut self, changes: <a class="struct" href="../primitives/map/hash_map/struct.HashMap.html" title="struct forge::revm::primitives::map::hash_map::HashMap">HashMap</a>&lt;<a class="struct" href="../primitives/struct.Address.html" title="struct forge::revm::primitives::Address">Address</a>, <a class="struct" href="../state/struct.Account.html" title="struct forge::revm::state::Account">Account</a>, <a class="struct" href="../primitives/map/foldhash/fast/struct.RandomState.html" title="struct forge::revm::primitives::map::foldhash::fast::RandomState">RandomState</a>&gt;)</h4></section></div></details><details class="toggle implementors-toggle"><summary><section id="impl-DatabaseCommit-for-OverlayDb%3CDb%3E" class="impl"><a href="#impl-DatabaseCommit-for-OverlayDb%3CDb%3E" class="anchor">§</a><h3 class="code-header">impl&lt;Db&gt; <a class="trait" href="../trait.DatabaseCommit.html" title="trait forge::revm::DatabaseCommit">DatabaseCommit</a> for OverlayDb&lt;Db&gt;</h3><div class="docblock"><p>Implementation of <code>DatabaseCommit</code> for <code>OverlayDb</code>.</p>
</div></section></summary><div class="docblock"><p>This implementation commits EVM state changes only to the overlay cache,
not to any underlying database. This is useful for:</p>
<ul>
<li>Temporary state modifications that shouldn’t persist to disk</li>
<li>Testing and simulation scenarios</li>
<li>Building up state changes before a final commit to persistent storage</li>
</ul>
<h4 id="example-1"><a class="doc-anchor" href="#example-1">§</a>Example</h4>
<div class="example-wrap ignore"><a href="#" class="tooltip" title="This example is not tested">ⓘ</a><pre class="rust rust-example-rendered"><code><span class="kw">use </span>revm::primitives::{Account, AccountInfo, EvmState};
<span class="kw">use </span>std::collections::HashMap;

<span class="kw">let </span><span class="kw-2">mut </span>overlay_db = OverlayDb::&lt;SomeDb&gt;::default();
<span class="kw">let </span><span class="kw-2">mut </span>state = EvmState::new();

<span class="comment">// Add an account with some balance
</span>state.insert(
    <span class="macro">address!</span>(<span class="string">"0000000000000000000000000000000000000001"</span>),
    Account {
        info: AccountInfo {
            balance: U256::from(<span class="number">1000</span>),
            nonce: <span class="number">1</span>,
            ..Default::default()
        },
        storage: HashMap::new(),
        status: AccountStatus::Touched,
    }
);

<span class="comment">// Commit to overlay cache only
</span>overlay_db.commit(state);</code></pre></div>
</div><div class="impl-items"><section id="method.commit-3" class="method trait-impl"><a href="#method.commit-3" class="anchor">§</a><h4 class="code-header">fn <a class="fn">commit</a>(&amp;mut self, changes: <a class="struct" href="../primitives/map/hash_map/struct.HashMap.html" title="struct forge::revm::primitives::map::hash_map::HashMap">HashMap</a>&lt;<a class="struct" href="../primitives/struct.Address.html" title="struct forge::revm::primitives::Address">Address</a>, <a class="struct" href="../state/struct.Account.html" title="struct forge::revm::state::Account">Account</a>, <a class="struct" href="../primitives/map/foldhash/fast/struct.RandomState.html" title="struct forge::revm::primitives::map::foldhash::fast::RandomState">RandomState</a>&gt;)</h4></section></div></details><details class="toggle implementors-toggle"><summary><section id="impl-DatabaseCommit-for-ForkDb%3CExtDb%3E" class="impl"><a href="#impl-DatabaseCommit-for-ForkDb%3CExtDb%3E" class="anchor">§</a><h3 class="code-header">impl&lt;ExtDb&gt; <a class="trait" href="../trait.DatabaseCommit.html" title="trait forge::revm::DatabaseCommit">DatabaseCommit</a> for ForkDb&lt;ExtDb&gt;</h3></section></summary><div class="impl-items"><section id="method.commit-4" class="method trait-impl"><a href="#method.commit-4" class="anchor">§</a><h4 class="code-header">fn <a class="fn">commit</a>(&amp;mut self, changes: <a class="struct" href="../primitives/map/hash_map/struct.HashMap.html" title="struct forge::revm::primitives::map::hash_map::HashMap">HashMap</a>&lt;<a class="struct" href="../primitives/struct.Address.html" title="struct forge::revm::primitives::Address">Address</a>, <a class="struct" href="../state/struct.Account.html" title="struct forge::revm::state::Account">Account</a>, <a class="struct" href="../primitives/map/foldhash/fast/struct.RandomState.html" title="struct forge::revm::primitives::map::foldhash::fast::RandomState">RandomState</a>&gt;)</h4></section></div></details><details class="toggle implementors-toggle"><summary><section id="impl-DatabaseCommit-for-MultiForkDb%3CExtDb%3E" class="impl"><a href="#impl-DatabaseCommit-for-MultiForkDb%3CExtDb%3E" class="anchor">§</a><h3 class="code-header">impl&lt;ExtDb&gt; <a class="trait" href="../trait.DatabaseCommit.html" title="trait forge::revm::DatabaseCommit">DatabaseCommit</a> for MultiForkDb&lt;ExtDb&gt;<div class="where">where
    ExtDb: <a class="trait" href="../trait.DatabaseCommit.html" title="trait forge::revm::DatabaseCommit">DatabaseCommit</a>,</div></h3></section></summary><div class="impl-items"><section id="method.commit-5" class="method trait-impl"><a href="#method.commit-5" class="anchor">§</a><h4 class="code-header">fn <a class="fn">commit</a>(&amp;mut self, changes: <a class="struct" href="../primitives/map/hash_map/struct.HashMap.html" title="struct forge::revm::primitives::map::hash_map::HashMap">HashMap</a>&lt;<a class="struct" href="../primitives/struct.Address.html" title="struct forge::revm::primitives::Address">Address</a>, <a class="struct" href="../state/struct.Account.html" title="struct forge::revm::state::Account">Account</a>, <a class="struct" href="../primitives/map/foldhash/fast/struct.RandomState.html" title="struct forge::revm::primitives::map::foldhash::fast::RandomState">RandomState</a>&gt;)</h4></section></div></details><details class="toggle implementors-toggle"><summary><section id="impl-DatabaseCommit-for-Box%3CT%3E" class="impl"><a href="#impl-DatabaseCommit-for-Box%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../trait.DatabaseCommit.html" title="trait forge::revm::DatabaseCommit">DatabaseCommit</a> for <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;T&gt;<div class="where">where
    T: <a class="trait" href="../trait.DatabaseCommit.html" title="trait forge::revm::DatabaseCommit">DatabaseCommit</a> + ?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</div></h3></section></summary><div class="impl-items"><section id="method.commit-6" class="method trait-impl"><a href="#method.commit-6" class="anchor">§</a><h4 class="code-header">fn <a class="fn">commit</a>(&amp;mut self, changes: <a class="struct" href="../primitives/map/hash_map/struct.HashMap.html" title="struct forge::revm::primitives::map::hash_map::HashMap">HashMap</a>&lt;<a class="struct" href="../primitives/struct.Address.html" title="struct forge::revm::primitives::Address">Address</a>, <a class="struct" href="../state/struct.Account.html" title="struct forge::revm::state::Account">Account</a>, <a class="struct" href="../primitives/map/foldhash/fast/struct.RandomState.html" title="struct forge::revm::primitives::map::foldhash::fast::RandomState">RandomState</a>&gt;)</h4></section></div></details><h2 id="implementors" class="section-header">Implementors<a href="#implementors" class="anchor">§</a></h2><div id="implementors-list"><section id="impl-DatabaseCommit-for-Backend" class="impl"><a class="src rightside" href="../../../src/foundry_evm_core/backend/mod.rs.html#1534">Source</a><a href="#impl-DatabaseCommit-for-Backend" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="../trait.DatabaseCommit.html" title="trait forge::revm::DatabaseCommit">DatabaseCommit</a> for <a class="struct" href="../../backend/struct.Backend.html" title="struct forge::backend::Backend">Backend</a></h3></section><section id="impl-DatabaseCommit-for-CowBackend%3C'_%3E" class="impl"><a class="src rightside" href="../../../src/foundry_evm_core/backend/cow.rs.html#333">Source</a><a href="#impl-DatabaseCommit-for-CowBackend%3C'_%3E" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="../trait.DatabaseCommit.html" title="trait forge::revm::DatabaseCommit">DatabaseCommit</a> for <a class="struct" href="../../backend/struct.CowBackend.html" title="struct forge::backend::CowBackend">CowBackend</a>&lt;'_&gt;</h3></section><section id="impl-DatabaseCommit-for-MemDb-1" class="impl"><a class="src rightside" href="../../../src/foundry_evm_core/backend/in_memory_db.rs.html#75">Source</a><a href="#impl-DatabaseCommit-for-MemDb-1" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="../trait.DatabaseCommit.html" title="trait forge::revm::DatabaseCommit">DatabaseCommit</a> for forge::backend::<a class="struct" href="../../backend/struct.MemDb.html" title="struct forge::backend::MemDb">MemDb</a></h3></section><section id="impl-DatabaseCommit-for-ForkedDatabase" class="impl"><a class="src rightside" href="../../../src/foundry_evm_core/fork/database.rs.html#196">Source</a><a href="#impl-DatabaseCommit-for-ForkedDatabase" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="../trait.DatabaseCommit.html" title="trait forge::revm::DatabaseCommit">DatabaseCommit</a> for <a class="struct" href="../../fork/database/struct.ForkedDatabase.html" title="struct forge::fork::database::ForkedDatabase">ForkedDatabase</a></h3></section><section id="impl-DatabaseCommit-for-State%3CDB%3E" class="impl"><a href="#impl-DatabaseCommit-for-State%3CDB%3E" class="anchor">§</a><h3 class="code-header">impl&lt;DB&gt; <a class="trait" href="../trait.DatabaseCommit.html" title="trait forge::revm::DatabaseCommit">DatabaseCommit</a> for <a class="struct" href="struct.State.html" title="struct forge::revm::database::State">State</a>&lt;DB&gt;<div class="where">where
    DB: <a class="trait" href="../trait.Database.html" title="trait forge::revm::Database">Database</a>,</div></h3></section><section id="impl-DatabaseCommit-for-CacheDB%3CExtDB%3E" class="impl"><a href="#impl-DatabaseCommit-for-CacheDB%3CExtDB%3E" class="anchor">§</a><h3 class="code-header">impl&lt;ExtDB&gt; <a class="trait" href="../trait.DatabaseCommit.html" title="trait forge::revm::DatabaseCommit">DatabaseCommit</a> for <a class="struct" href="struct.CacheDB.html" title="struct forge::revm::database::CacheDB">CacheDB</a>&lt;ExtDB&gt;</h3></section><section id="impl-DatabaseCommit-for-WrapDatabaseRef%3CT%3E" class="impl"><a href="#impl-DatabaseCommit-for-WrapDatabaseRef%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../trait.DatabaseCommit.html" title="trait forge::revm::DatabaseCommit">DatabaseCommit</a> for <a class="struct" href="struct.WrapDatabaseRef.html" title="struct forge::revm::database::WrapDatabaseRef">WrapDatabaseRef</a>&lt;T&gt;<div class="where">where
    T: <a class="trait" href="../trait.DatabaseRef.html" title="trait forge::revm::DatabaseRef">DatabaseRef</a> + <a class="trait" href="../trait.DatabaseCommit.html" title="trait forge::revm::DatabaseCommit">DatabaseCommit</a>,</div></h3></section></div><script src="../../../trait.impl/revm_database_interface/trait.DatabaseCommit.js" data-ignore-extern-crates="alloc,revm_database_interface,revm_database,foundry_evm_core,foundry_fork_db,assertion_executor" async></script></section></div></main></body></html>